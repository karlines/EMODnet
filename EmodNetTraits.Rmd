---
title: "Trait-based products of EMODnet benthic biology"
author: "Karline Soetaert, Olivier Beauchard, Peter Herman"
date: "9 October 2018"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

# Abstract


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(plot3D)
require(viridis)
```


# Aim of this analysis. 

Throught their activity, benthic animals play an important role in marine ecosystem functioning. More specifically, they mix the sediment by their movement and feeding activity, a process called "bioturbation". They also create water movements, enhancing the exchange of dissolved constituents such as oxygen, and dissolved inorganic nutrients, a process called "bio-irrigation".

Both these activities have a large impact on the biogeochemical cycles in the environment, and they are commonly parameterised as single parameters in biogeochemical models. 

Biologists have tried to categorise the bioturbation or bio-irrigation activity based on the identity of the organims.  They do not derive the rate parameters as used in the biogeochemical models but rather derive a potential of the organisms to perform these tasks.


Here we use Benthic abundance data from EMODnet to estimate the bioturbation potential and the bioirrigation potential index. 

To derive these potentials we need information on:

* The weights of the species and their total biomass
* The species mobility and sediment reworking mode

# Reading the data

## Species taxonomic tree

The names of all species encountered in the dataset were checked against the WORMS database, and their taxonomic tree added (this was done via \url{http://www.marinespecies.org/}, menu item *tools/Match taxa*). These data are read first. The dimensions of the data set and the first two entries are printed.

```{r}
Taxo     <- read.csv(file= "taxo.csv")
cat("\ndimension and first part of the data set : \n")
dim(Taxo)
head(Taxo, n = 2)
```

## the MWTL data

The MWTL data is the only data set that contains both species *biomass* and *densities* (the other data sets comprise only densities or just presence/absence). This data is used to estimate mean individual weights of the various species. 

Biomass is in *g AFDW/m2*, density in *number /m2*

```{r}
MWTLdata        <- read.csv( "densbiomassMWTL.csv")
colnames(MWTLdata)[2] <- "tx"
cat("\ndimension and first part of the data set : \n")
dim (MWTLdata)
head(MWTLdata, n = 2)
```


## Species body mass

There are two biomass data sets. The first data set was prepared by Olivier Beauchard; it contains the body mass in ash-free dry weight.

```{r}
mws.ol <- read.csv("BodyMass.csv")
cat("\ndimension and first part of the data set : \n")
dim(mws.ol)
head(mws.ol, n = 2)
```

Another dataset was derived from the MWTL data series by Peter Herman; it contains both the mean weight (*mw*) and geometric mean weight (*gmw*), in ash-free dry weight, and the number of instances on which this was determined (*n*).

```{r}
mws.mwtl <- read.csv("mweights.csv")
cat("\ndimension and first part of the data set : \n")
dim(mws.mwtl)
head(mws.mwtl, n = 2)
```

### Checking consistency in weight data

Both data sets contain species weights that are not present in the other data set, so they are merged. 
First it is checked if the data are compatible.

```{r, fig.width=4, fig.height=4}
cat("number of species in first dataset absent in second: ", length(which(! mws.ol$tx  %in% mws.mwtl$species)), "\n")
cat("number of species in second dataset absent in first: ", length(which(! mws.mwtl$species  %in% mws.ol$tx)), "\n")

Check <- merge(mws.ol[,1:2], mws.mwtl[,2:3], by.x = "tx", by.y = "species")
cat("number of species in common: ", nrow(Check), "\n")

with(Check, plot(BodyMassAFWD, mw, log= "xy", xlab = "weight dataset 1", ylab = "weight dataset 2", main = "comparison body mass"))
```

### Combining the two weight datasets.

We combine both data sets and add the taxonomic tree by merging the data with the taxon data.

```{r}
colnames(mws.ol)[1:2]     <- c("tx", "avweight")
colnames(mws.mwtl)[2:3]   <- c("tx", "avweight")

mws.all <- rbind(mws.mwtl[,2:3], mws.ol[,1:2])
mws.all <- merge(mws.all, Taxo, by = "tx")
```

### Expanding the weight dataset

Next we estimate mean weights on species level, on genus level and on the family level, and bind all in one data.frame(mws).

```{r}
mws.species <- data.frame(meanW = tapply(mws.all$avweight,INDEX = mws.all$tx, FUN = mean, na.rm = TRUE),
                          sdW   = tapply(mws.all$avweight,INDEX = mws.all$tx, FUN = sd,   na.rm = TRUE),
                          n     = tapply(mws.all$avweight,INDEX = mws.all$tx, FUN = length),
                          level = "species")


mws.genus   <- data.frame(meanW = tapply(mws.all$avweight,INDEX = mws.all$gen, FUN = mean, na.rm = TRUE),
                          sdW   = tapply(mws.all$avweight,INDEX = mws.all$gen, FUN = sd,   na.rm = TRUE),
                          n     = tapply(mws.all$avweight,INDEX = mws.all$gen, FUN = length),
                          level = "genus")
mws.genus   <- mws.genus[-which(rownames(mws.genus)==""),]
mws.genus   <- subset(mws.genus, !is.na(meanW))


mws.family  <- data.frame(meanW = tapply(mws.all$avweight,INDEX = mws.all$fam, FUN = mean, na.rm = TRUE),
                          sdW   = tapply(mws.all$avweight,INDEX = mws.all$fam, FUN = sd,   na.rm = TRUE),
                          n     = tapply(mws.all$avweight,INDEX = mws.all$fam, FUN = length),
                          level = "family")
mws.family  <- mws.family[-which(rownames(mws.family)==""),]
mws.family  <- subset(mws.family, !is.na(meanW))

mws <- rbind(mws.species, mws.genus, mws.family)
mws$taxon <- rownames(mws)

```

The total number of weight values thus obtained is `r nrow(mws)`, of which `r nrow(mws.species)` are estimated at species level, `r nrow(mws.genus)` at genus level and `r nrow(mws.family)` at family level.



## FeedingTypes

Feedingtypes are known from a subset of the species. The following types are distinguished:

* CaSc = carnivore/scavenger
* De = depositfeeder
* He = herbivore
* Om = omnivore
* Pa = parasite
* Su = suspension feeder
* SuDe = suspension/deposit feeder

```{R}
FeedingType <- read.csv("feedingtype_matched.txt")
cat("\ndimension and first part of the data set : \n")
head(FeedingType[,1:2], n = 2)
table(FeedingType$Trophy)
```

### Feeding types on higher taxonomic levels

We now assign feeding types to the genera and families, for which we take the most commonly encountered feedingtype at the lower level.

```{r}
ft.species <- data.frame(FeedingType[,1:2], level = "species")
colnames(ft.species)[1:2] <- c("taxon", "ft")
ft.species$n <- 1

ft.genus <- data.frame(ft    = tapply(FeedingType$Trophy, INDEX = FeedingType$Genus, 
                                   FUN = function(x) names(sort(table(x), decreasing = TRUE)[1])), 
                       n     = tapply(FeedingType$Trophy, INDEX = FeedingType$Genus, FUN = length))
ft.genus  <- data.frame(taxon = rownames(ft.genus), ft.genus, level = "genus")

ft.family <- data.frame(ft = tapply(FeedingType$Trophy, INDEX = FeedingType$Family, 
                                   FUN = function(x) names(sort(table(x), decreasing = TRUE)[1])), 
                       n   = tapply(FeedingType$Trophy, INDEX = FeedingType$Family, FUN = length))
ft.family <- data.frame(taxon = rownames(ft.family), ft.family, level = "family")

ft <- rbind(ft.species, ft.genus, ft.family)
head(ft, n = 2)
```

The total number of feeding types thus obtained is `r nrow(ft)`, of which `r nrow(ft.species)` are known at species level, `r nrow(ft.genus)` at genus level and `r nrow(ft.family)` at family level.

## life history traits

Life history traits are also assigned on genus and family level, where we take the most commonly encountered trait at the lower level. 


```{R}
Traits.all <- read.csv("TraitsBiotur.csv")
cat("\ndimension and first part of the data set : \n")
dim(Traits.all)
head(Traits.all, n = 2)

traits.species <- data.frame(Traits.all[,c("taxon","Motility","Body.size","Burrowing.depth","Morphology","Mobility","Mixing.type", 
  "Mixing.rate", "Mi", "Mi2", "Ri", "Morphology.2", "Morphology.2.1", "Body.size.2", "Burrowing.depth.2", "Mixing.rate.2")], 
   n = 1, level = "species")

traitfun <- function(taxon = "gen", what = "Motility"){ 
  X <- data.frame(what = tapply(Traits.all[,what], INDEX = Traits.all[,taxon], 
                                   FUN = function(x) names(sort(table(x), decreasing = TRUE)[1])), 
             n =  tapply(Traits.all[,what], INDEX = Traits.all[,taxon], FUN = length))
  colnames(X)[1] <- what
  X
}

traitfun.all <- function(taxon){
  T <- traitfun(taxon, what = "Motility")
  n <- T$n
  X <- T[,1]
  What <- c("Motility", "Body.size", "Burrowing.depth", "Morphology", "Mobility", "Mixing.type", 
"Mixing.rate", "Mi", "Mi2", "Ri", "Morphology.2", "Morphology.2.1", "Body.size.2", "Burrowing.depth.2","Mixing.rate.2")
  
  for (w in What[-1])
    X <- data.frame(X,  traitfun(taxon, what = w)[,1])
  names(X) <- What
  X <- data.frame(taxon = rownames(T), X, n = n)
}

traits.genus  <- traitfun.all("gen")
traits.genus$level <- "genus"
traits.family <- traitfun.all("fam")
traits.family$level <- "family"

traits <- rbind(traits.species, traits.genus[!traits.genus$taxon %in% traits.species$taxon,])
traits <- rbind(traits, traits.family[!traits.family$taxon %in% traits$taxon,])

```

The total number of traits thus obtained is `r nrow(traits)`, of which `r nrow(traits.species)` are estimated at species level, `r nrow(traits.genus)` at genus level and `r nrow(traits.family)` at family level.


We tabulate the number of occurrences of each trait in the resulting data.frame.

```{R, echo = FALSE}
cat("motility:");        table(traits$Motility)
cat("Body size:");       table(traits$Body.size)
cat("Burrowing depth:"); table(traits$Burrowing.depth)
cat("Morphology:");      table(traits$Morphology)
cat("Mobility:");        table(traits$Mobility)
cat("Mixing type:");     table(traits$Mixing.type)
cat("Mixing rate:");     table(traits$Mixing.rate)
cat("Mi:");              table(traits$Mi)
cat("Ri:");              table(traits$Ri)
```

## The density data

Density data are read.

```{r}
occ <- read.csv("df_ab.csv")

cat("\ndimension and first part of the data set : \n")
dim(occ)
head(occ, n = 2)

cat("\ntotal number of data points per provider : \n")
table(occ$data)
```

Some data providers did not record density, but just presence/absence; these data are removed.

```{r}
occ      <- occ[!is.na(occ$dens), ]
occ$data <- droplevels(occ$data)

occ$ID <- paste(occ$sta, occ$tx, sep = "")
```

The total number of species in this data set is `r length(unique(occ$tx))`

# A look at the data 

Species densities are summed per station to give the total densities

```{r}
TotalDensity <- aggregate(occ$dens, by = list(data = occ$data, sta = occ$sta, x = occ$x, y = occ$y), FUN = sum)
names(TotalDensity)[5] <- "TotalDens"
cat("total number of stations per provider : \n")
table(TotalDensity$data)

```

The total number of stations in this data set is `r nrow(TotalDensity)`

The positions of the stations are plotted, colored according to the data provider

```{r, fig.width = 6, fig.height = 6}
require(rworldmap) 
mapGriddedData(colourPalette = rep("white", 5), oceanCol = grey(0.97), addLegend = FALSE, 
               xlim = c(-10,20), ylim = c(45,65))
title( "data providers")
with(TotalDensity, points(x, y, pch = ".", cex = 3,  col = data))

legend("bottomright", pch = 16, cex = 0.7, col = 1:20, legend = levels(TotalDensity$data))

```


```{r}
with (TotalDensity, boxplot((TotalDens)~data, outline = FALSE, las = 2, main = "Mean Density", log = "y"))
```



# Adding individual weights and traits to density data 

Weights and trait information is not available for all species, even after determining this information on genus and familiy level. 
We create data sets that remove the species that do not have all information. 
We then calculate total density on this reduced data set and see what fraction of total density we obtain. 

First the required taxonomic information is added to the density list:

```{r}
which(!occ$tx %in% Taxo$txa)

TaxoSpec <- Taxo$txa %in% occ$tx 
TaxoUsed <- Taxo[Taxo$txa%in%occ$tx ,]
occ.full <- merge(occ, TaxoUsed, by.x = "tx", by.y = "tx")
```

To merge density data with the other data sets, a function is created


```{r}
MergeData <- function(density = occ.full, data2){

  DataWithBiomass    <-       merge(density,            data2, by.x = "tx", by.y = "taxon")   # merging at species level

  DataWithoutBiomass <- density[!density$ID %in% DataWithBiomass$ID, ]
  DataWithBiomass    <- rbind(DataWithBiomass,
                              merge(DataWithoutBiomass, data2, by.x = "gen", by.y = "taxon"))

  DataWithoutBiomass <- density[!density$ID %in% DataWithBiomass$ID, ]
  DataWithBiomass    <- rbind(DataWithBiomass,
                              merge(DataWithoutBiomass, data2, by.x = "fam", by.y = "taxon"))

  DataWithoutBiomass <- density[!density$ID %in% DataWithBiomass$ID, ]

  totalDensity <- with (DataWithBiomass, aggregate(dens, by = list(data = data, sta = sta, x = x, y = y), FUN = sum))
  colnames(totalDensity)[5] <- "EstDens"
  list(complete = DataWithBiomass, incomplete = DataWithoutBiomass, DENS = totalDensity)
}


```

## Merging density and weights

```{r}
DensityWeight <- MergeData(density = occ.full, data2 = mws)
```


## Merging density and traits

```{r}
DensityTrait <- MergeData(density = occ.full, data2 = traits)
```


Merging density and feeding types

```{r}
DensityFT <- MergeData(density = occ.full, data2 = ft)
```

Data that have all necessary information for estimating bioturbation potential 

```{r}
DataAll <- merge(DensityWeight$complete [, c("tx", "data","sta","x","y", "dens","ID", "meanW")], 
                 DensityTrait$complete[, c("ID","Motility", "Body.size", "Burrowing.depth", "Morphology", "Mobility", "Mixing.type", 
                                         "Mixing.rate", "Mi", "Mi2", "Ri", "Morphology.2", "Morphology.2.1", 
                                        "Body.size.2", "Burrowing.depth.2","Mixing.rate.2")], by = "ID", suffixes = "")

dim(DataAll)
dim(occ.full)
```

The fraction of data that has all information to estimate bioturbation potential = `r nrow(DataAll)/nrow(occ.full)`

## Check on the representativeness of the reduced data set

For the mwtl data we now compare the measured biomass with the biomass that we estimate, based on mean weights.

```{r, fig.width=8, fig.height=5}
par(mfrow = c(1,3))
mws.species$tx <- rownames(mws.species)
MWTL.data <- subset(MWTLdata, density > 0 & biomass > 0)
MWTL.data <- merge(MWTL.data,Taxo)
mwscompare     <- merge(mws.species, MWTL.data)
with(mwscompare, plot(biomass, density*meanW, log = "xy", pch = ".", cex = 3, 
          xlab = "measured density", ylab = "estimated based on mean weight", main = "species level"))
with(mwscompare, summary(density*meanW-biomass))

mws.genus$gen <- rownames(mws.genus)
mwscompare     <- merge(mws.genus, MWTL.data)
with(mwscompare, plot(biomass, density*meanW, log = "xy", pch = ".", cex = 3,
          xlab = "measured density", ylab = "estimated based on mean weight", main = "genus level"))
with(mwscompare, summary(density*meanW-biomass))

mws.family$fam <- rownames(mws.family)
mwscompare     <- merge(mws.family, MWTL.data)
with(mwscompare, plot(biomass, density*meanW, log = "xy", pch = ".", cex = 3,  
          xlab = "measured density", ylab = "estimated based on mean weight", main = "family level"))
with(mwscompare, summary(density*meanW-biomass))

```

We also check the error we would make in the density data if we would estimate them on the merged data sets.

```{r, fig.width=8, fig.height=5}

DENS <- merge(TotalDensity, DensityWeight$DENS); colnames(DENS)[ncol(DENS)] <- "EstDens.W"
DENS <- merge(DENS, DensityTrait$DENS); colnames(DENS)[ncol(DENS)] <- "EstDens.TR"
DENS <- merge(DENS, DensityFT$DENS); colnames(DENS)[ncol(DENS)] <- "EstDens.FT"

TotDensAll <- with(DataAll, aggregate(dens, by = list(data = data, sta = sta, x = x, y = y), FUN = sum))
colnames(TotDensAll)[5] <- "EstDens.BPC"
DENS <- merge(DENS, TotDensAll)

boxplot(DENS[,-(1:4)], log = "", outline = FALSE)

cat("fraction of density based on species for which weight is known:\n")
with(DENS, summary(EstDens.W/TotalDens))
cat("fraction of density based on species for which traits are known:\n")
with(DENS, summary(EstDens.TR/TotalDens))
cat("fraction of density based on species for which feeding type is known:\n")
with(DENS, summary(EstDens.FT/TotalDens))
cat("fraction of density based on species for which all is known:\n")
with(DENS, summary(EstDens.BPC/TotalDens))
```

The estimated density if we only use species for which have all data required for BPc estimation is thus on average `r with(DENS, mean(EstDens.BPC/TotalDens))` of the true value.

As we want to estimate bioturbation potential, we now split this number for the different data providers

```{r, fig.width=8, fig.height=8}
par(mfrow = c(3,1))
DENS$r.bpc <- DENS$EstDens.BPC/DENS$TotalDens
DENS$r.w   <- DENS$EstDens.W/DENS$TotalDens
DENS$r.ft  <- DENS$EstDens.FT/DENS$TotalDens
with(DENS, boxplot(r.bpc ~ data, main = "estimated fraction of density for BPc calculations"))
with(DENS, boxplot(r.w ~ data, main = "estimated fraction of density for Weights"))
with(DENS, boxplot(r.ft ~ data, main = "estimated fraction of density for Feeding types"))
```

The recovered fraction of density:

```{r}
data.frame(BPC = with(DENS, tapply(r.bpc, INDEX =  data, FUN = mean)),
           W = with(DENS, tapply(r.w, INDEX =  data, FUN = mean)),
           FT = with(DENS, tapply(r.ft, INDEX =  data, FUN = mean)))
```


# Estimating BPc, the bioturbation potential

The bioturbation potential is now estimated on the reduced data set. First the contribution of each species to BPc is estimated.


```{r}
BPc_Bio <- function(biomass, abundance, mobility, rework)
  sqrt(biomass/abundance) * abundance * mobility * rework

BPc <- function(weight, abundance, mobility, rework)
  sqrt(weight) * abundance * mobility * rework

DataAll$BPC <- BPc(DataAll$meanW, DataAll$dens, as.numeric(DataAll$Mi), as.numeric(DataAll$Ri))
DataAll$Biomass <-DataAll$meanW * DataAll$dens
```

Then the BPcs of all species per station are added.

```{r}

TotalBPC <- with (DataAll, aggregate(BPC, by=list(data = data, sta = sta, x = x, y = y), FUN=sum, na.rm = TRUE))

names(TotalBPC)[5] <- "BPC"
```

```{r, fig.height=5, fig.width=10}
with(TotalBPC, boxplot(BPC~data, main = "BPc", log = "y", las = 2))
```

## Biomass and total density

TotalDensity was already calculated

```{r, fig.height=5, fig.width=10}
with(TotalDensity, boxplot(TotalDens~data, main = "Total density", log = "y", las = 2))
```

The total biomass per station:

```{r}
TotalBiomass <- with(DensityWeight$complete, aggregate(dens*meanW, by=list(data = data, sta = sta, x = x, y = y), FUN=sum, na.rm = TRUE))
colnames(TotalBiomass)[5] <- "AFDW"
```


```{r, fig.height=5, fig.width=10}
with(TotalBiomass, boxplot(AFDW~data, main = "Total biomass", log = "y", las = 2))
```


```{r, fig.height=10, fig.width=10}
par(mfrow = c(2,2), oma = c(0,0,0,2))
with(TotalDensity, points2D(x, y, colvar = TotalDens, main = "Density, ind/m2", 
                            log = "c", pch = ".", cex = 4, las = 1))
with(TotalBiomass, points2D(x, y, colvar = AFDW, main = "AFDW, g/m2", 
                            log = "c", pch = ".", cex = 4, las = 1))
with(TotalBPC, points2D(x, y, colvar = BPC, main = "BPc", log = "c", pch = ".", cex = 4, 
                        las = 1))
```


## Biomass per feeding type

```{r, fig.width = 10, fig.height=5}
Weight_FT <- merge(DensityFT$complete[,c(1:7,15)], DensityWeight$complete[,c(7,15)], by = "ID")
Weight_FT$Biomass <- Weight_FT$dens * Weight_FT$meanW

FT_Stats <- with(Weight_FT, tapply(Biomass, INDEX = list(sta, ft), FUN = sum, na.rm = TRUE))
FT_Stats <- data.frame(sta = rownames(FT_Stats), FT_Stats, 
                       AFDW_FT = rowSums(FT_Stats, na.rm = TRUE))
FT_Stats <- merge(TotalBiomass,FT_Stats, by = "sta")
head(FT_Stats)
```

The stations where none of the feeding types are known are removed, and the most dominant feeding type selected.

```{r}
ISNAS <- unlist(apply(FT_Stats[,6:12], FUN = function(x) sum(is.na(x)), MARGIN = 1))
table(ISNAS)
FT_Stats <- FT_Stats[ISNAS < 7,]
NAMES <- colnames(FT_Stats)[6:12]
FT_Stats$dominant <- unlist(apply(FT_Stats[,6:12], FUN = function(x) NAMES[which.max(x)], MARGIN = 1))
FT_Stats$dominant <- as.factor(FT_Stats$dominant)
```

```{r, fig.height=10, fig.width=10}
FTnames <- as.data.frame(matrix(ncol = 2, byrow = TRUE, data = c( 
 "CaSc" , "carnivore/scavenger",
 "De" , "depositfeeder",
 "He" , "herbivore",
 "Om" , "omnivore",
 "Su" , "suspension feeder",
 "SuDe" , "suspension/deposit feeder"
)))
with (FT_Stats, plot(x, y, col = c(1:6)[dominant], pch = ".", cex = 5, main = "Dominant feeding type"))
legend("bottomright", col = 1:6, legend = FTnames[FTnames[,1]==as.character(levels(FT_Stats$dominant)),2], pch = 16, cex = 1.25)
```

```{r, fig.height=10, fig.width=10}
par(mfrow = c(2,1))
with(FT_Stats, boxplot(Om~data, main = "Total biomass Omnivores", log = "y", las = 2))
with(FT_Stats, boxplot(De~data, main = "Total biomass Deposit feeders", log = "y", las = 2))
```





```{r, fig.height=10, fig.width=10}
par(mfrow = c(2,1))
with(FT_Stats, boxplot(Su~data, main = "Total biomass Suspension feeders", log = "y", las = 2))
with(FT_Stats, boxplot(CaSc~data, main = "Total biomass Carnivore/scavengers", log = "y", las = 2))
```


The total biomasses of feeding types

```{r, fig.height=10, fig.width=10}
par(mfrow = c(2,2), oma = c(0,0,0,2))
with(FT_Stats, points2D(x, y, colvar = Om, main = "Total biomass Omnivores", 
                        pch = ".", cex = 3, log = "c", las = 1))
with(FT_Stats, points2D(x, y, colvar = De, main = "Total biomass Deposit feeders", 
                       pch = ".", cex = 3, log = "c", las = 1))

with(FT_Stats, points2D(x, y, colvar = Su, main = "Total biomass Suspension feeders", 
                       pch = ".", cex = 3, log = "c", las = 1))
with(FT_Stats, points2D(x, y, colvar = CaSc, main = "Total biomass Carnivore/scavengers", 
                       pch = ".", cex = 3, log = "c", las = 1))
```


The relative biomasses of feeding types

```{r, fig.height=10, fig.width=10}
par(mfrow = c(2,2), oma = c(0,0,0,2))
FT_rel <- FT_Stats
FT_rel[,6:12] <- FT_rel[,6:12]/FT_rel$AFDW_FT


with(FT_rel, points2D(x, y, colvar = Om, main = "relative biomass Omnivores", 
                        pch = ".", cex = 4, log = "c", las = 1, clim = c(0.01, 1)))
with(FT_rel, points2D(x, y, colvar = De, main = "relative biomass Deposit feeders", 
                       pch = ".", cex = 4, log = "c", las = 1, clim = c(0.01, 1)))
with(FT_rel, points2D(x, y, colvar = Su, main = "relative biomass Suspension feeders", 
                       pch = ".", cex = 4, log = "c", las = 1, clim = c(0.01, 1)))
with(FT_rel, points2D(x, y, colvar = CaSc, main = "relative biomass Carnivore/scavengers", 
                       pch = ".", cex = 4, log = "c", las = 1, clim = c(0.01, 1)))
```


# Writing the results

```{r}
write.csv(file = "results/Density.csv", TotalDensity)
write.csv(file = "results/Biomass.csv", TotalBiomass)
write.csv(file = "results/BPC.csv", TotalBPC)
SuspensionFeeders <- FT_Stats[,c(2,1,3,4,11)]; names(SuspensionFeeders)[5] <- "AFDW_S"
DepositFeeders <- FT_Stats[,c(2,1,3,4,7)]; names(DepositFeeders)[5] <- "AFDW_D"
write.csv(file = "results/SuspensionFeeders.csv", SuspensionFeeders)
write.csv(file = "results/DepositFeeders.csv", DepositFeeders)
```
